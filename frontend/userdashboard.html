<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Evergreen Financial - User Dashboard</title>
  <link rel="stylesheet" href="userdashboard.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
</head>
<body>
  <!-- Header -->
  <header>
    <section class="nav-bar">
      <div class="hero-image">
        <img src="images/evergreen_transparent.png" alt="Evergreen Financial Bank" width="200" height="200">
      </div>
      <div class="nav">
        <ul>
          <li><a href="userdashboard.html">Dashboard</a></li>
          <li><a href="accounts.html">Accounts</a></li>
          <li><a href="transfer.html">Transfer</a></li>
          <li><a href="payments.html">Payments</a></li>
          <li><a href="settings.html">Settings</a></li>
          <li><a href="signin.html">Logout</a></li>
        </ul>
      </div>
    </section>
  </header>

  <!-- Main Dashboard -->
  <main>
    <section class="user-overview">
      <h2>Welcome back </h2> <h2 class="user-name"></h2> <h2 class="user-number"></h2>
      <p>Your financial summary at a glance.</p>

      <div class="cards-container">
        <div class="card">
          <i class="fa fa-wallet"></i>
          <h3>Account Balance</h3>
          <p class="user-balance"></p>
        </div>
        <div class="card">
          <i class="fa fa-piggy-bank"></i>
          <h3>Savings Balance</h3>
          <p class="user-savings"></p>
        </div>
        <div class="card">
          <i class="fa fa-credit-card"></i>
          <h3>Credit Card</h3>
          <p class="user-card"> due</p>
        </div>
      </div>
    </section>

    <section class="quick-actions">
      <h3>Quick Actions</h3>
      <div class="actions-grid">
        <a href="transfer.html" class="action-btn"><i class="fa fa-exchange-alt"></i> Transfer Funds</a>
        <a href="payments.html" class="action-btn"><i class="fa fa-file-invoice"></i> Pay Bills</a>
        <a href="accounts.html" class="action-btn"><i class="fa fa-university"></i> View Accounts</a>
      </div>
    </section>

    <section>
      <h3>Recent Transactions</h3>
      <table id="transactions">
        <thead>
          <tr>
            <th>Description</th>
            <th>Type</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody>
          
        </tbody>
      </table>
    </section>
  </main>

  <!-- Footer -->
  <footer>
        <div class="footer-container">
            <h4>Contact Us</h4>
            <p id="email">Email: <a href="mailto:evergreen@support.com">evergreen@support.com</a>
            <p>&copy; 2025 Evergreen Financial Bank. All rights reserved.</p>
            <nav>
                <ul>
                    <li><a href="">Privacy Policy</a></li>
                    <li><a href="">Terms of Service</a></li>
                    <li><a href="">Contact Us</a></li>
                </ul>
            </nav>
        </div>
        <div class="social-media">
            <a href="facebook"><i class="fa-brands fa-facebook"></i></a>
            <a href="twitter"><i class="fa-brands fa-twitter"></i></a>
            <a href="instagram"><i class="fa-brands fa-instagram"></i></a>
            <a href="whatsapp"><i class="fa-brands fa-whatsapp"></i></a>
        </div>        
    </footer>
    <script>
          const params = new URLSearchParams(window.location.search);
          const email = params.get("email");

          if (!email) {
            document.getElementById("profile").innerHTML = "<p>No user email provided.</p>";
          } else {
            fetch(`/dashboard/${email}`)
              .then(res => res.json())
              .then(data => {
                if (data.success) {
                  const profile = data.user;

                  // Fill profile info
                  document.querySelector(".user-name").textContent =
                    `${profile.firstname} ${profile.secondname}`;
                  document.querySelector(".user-savings").textContent =
                    `₦${profile.savings_balance}`;
                  document.querySelector(".user-balance").textContent =
                    `₦${profile.account_balance}`;
                  document.querySelector(".user-card").textContent =
                    `₦${profile.card_balance}`;
                  document.querySelector(".user-number").textContent =
                    `${profile.account_number}`;

                  // Fill transactions table
                  const tbody = document.querySelector("#transactions tbody");
                  tbody.innerHTML = ""; // clear old rows
                  if (Array.isArray(data.transactions) && data.transactions.length > 0)
                  data.transactions.forEach(tx => {
                    const row = document.createElement("tr");
                    row.innerHTML = `
                      <td>${tx.description}</td>
                      <td>${tx.type}</td>
                      <td>₦${tx.amount}</td>
                      <td>${tx.status}</td>
                      <td>${tx.date}</td>
                    `;
                    tbody.appendChild(row);
                  });

                } else {
                  document.getElementById("profile").innerHTML =
                    `<p>Error: ${data.message}</p>`;
                }
              })
              .catch(err => {
                console.error("Error fetching profile:", err);
                document.getElementById("profile").innerHTML =
                  "<p>Failed to load profile data.</p>";
              });
          }
</script>

</body>
</html>
